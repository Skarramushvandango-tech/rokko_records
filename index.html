<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ROKKO! Records</title>
  <meta name="description" content="ROKKO! Records – Das kreative Musiklabel aus dem Ruhrpott. Künstler, Musik und mehr." />
  <link rel="icon" href="assets/images/logo-96.png"/>
  <link rel="stylesheet" href="assets/css/style.css"/>
</head>
<body>

  <!-- Header -->
  <header class="site-header" role="banner">
    <div class="brand">
      <picture class="brand__logo">
        <source srcset="assets/images/logo-96.png" media="(max-width: 640px)"/>
        <img src="assets/images/logo.png" alt="ROKKO! Records Logo"/>
      </picture>
      <div class="brand__title" aria-label="Seitentitel">
        <span class="brand__top">ROKKO!</span>
        <span class="brand__bottom">RECORDS</span>
      </div>
    </div>

    <button class="burger" type="button" aria-label="Menü öffnen" aria-expanded="false" aria-controls="menu">
      <span></span><span></span><span></span>
    </button>

    <nav class="menu" id="menu" aria-label="Hauptmenü">
      <a href="#releases">Aktuelle Releases</a>
      <a href="#artists">Artists</a>
      <a href="#henri">Henri Bellieu</a>
      <a href="#erling">Markus Erling</a>
      <a href="#fleur">Fleur &amp; Beunié</a>
      <a href="#skank">Skank Schablonski</a>
      <a href="#skaramush">SkaRamush Vandango</a>
      <a href="#contact">Kommentarfeld</a>
    </nav>
  </header>

  <!-- Hero-Video (vollbreit) -->
  <section class="hero" aria-label="Intro">
    <video id="introVideo" class="hero__video" autoplay muted loop playsinline
           src="assets/movies/intro_movie.mp4"></video>
    <button id="soundBtn" class="sound-btn" type="button" aria-pressed="true" aria-label="Ton umschalten">Ton: Aus</button>
  </section>

  <main>

    <!-- Headline-Rahmen: Releases -->
    <div id="releases" class="headline-frame" aria-label="Aktuelle Releases">
      <h2 class="headline-frame__title">Aktuelle Releases</h2>
    </div>

    <!-- Releases-Preview (Platzhalter) -->
    <section class="card">
      <div class="inner-block">
        <p class="coming-soon">comming soon</p>
      </div>
    </section>

    <!-- Headline-Rahmen: Artists -->
    <div id="artists" class="headline-frame" aria-label="Artists">
      <h2 class="headline-frame__title">Artists</h2>
    </div>

    <!-- HENRI -->
    <section id="henri" class="card artist" data-artist="HENRI">
      <div class="inner-block">
        <img class="artist__photo" src="artists/henri_bellieu/fotos/henri_main.png" alt="Henri Bellieu"/>
        <h3 class="subhead">Biografie</h3>
        <div class="bio" data-bio-id="bio-henri">
          <p class="bio-text collapsed">…</p>
          <button class="bio-toggle" type="button" aria-expanded="false" aria-controls="bio-henri-content">Text erweitern</button>
        </div>
        <hr class="sandline"/>
        <div class="music-intro"><span class="music-label">Musik</span></div>

        <div class="track-list">
          <button class="track" type="button" data-release="lafemme">
            <div class="thumb"><img src="artists/henri_bellieu/cover/la_femme.png" alt="Cover: La Femme"></div>
            <div class="track-meta"><span class="track-title">La Femme</span></div>
          </button>
          <button class="track" type="button" data-release="colibri">
            <div class="thumb"><img src="artists/henri_bellieu/cover/petite_colibri.png" alt="Cover: Petite Colibri"></div>
            <div class="track-meta"><span class="track-title">Petite Colibri</span></div>
          </button>
        </div>

        <div class="album-panel" hidden>
          <div class="album-panel__inner">
            <div class="cover-frame square">
              <img class="album-panel__cover" alt="Album Cover">
            </div>
            <div class="album-panel__players"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- ERLING -->
    <section id="erling" class="card artist" data-artist="ERLING">
      <div class="inner-block">
        <img class="artist__photo" src="artists/erling/fotos/erling_main.png" alt="Markus Erling"/>
        <h3 class="subhead">Biografie</h3>
        <div class="bio" data-bio-id="bio-erling">
          <p class="bio-text collapsed">…</p>
          <button class="bio-toggle" type="button" aria-expanded="false" aria-controls="bio-erling-content">Text erweitern</button>
        </div>
        <hr class="sandline"/>
        <div class="music-intro"><span class="music-label">Musik</span></div>

        <div class="track-list">
          <button class="track" type="button" data-release="schlafen">
            <div class="thumb"><img src="artists/erling/cover/endlich_schlafen_cover.png" alt="Cover: Endlich Schlafen"></div>
            <div class="track-meta"><span class="track-title">Endlich Schlafen</span></div>
          </button>
          <button class="track" type="button" data-release="regen">
            <div class="thumb"><img src="artists/erling/cover/regen_cover.png" alt="Cover: Der Tag an dem es regnet"></div>
            <div class="track-meta"><span class="track-title">Der Tag an dem es regnet</span></div>
          </button>
        </div>

        <div class="album-panel" hidden>
          <div class="album-panel__inner">
            <div class="cover-frame square">
              <img class="album-panel__cover" alt="Album Cover">
            </div>
            <div class="album-panel__players"></div>
          </div>
        </div>

        <hr class="sandline"/>
        <div class="youtube">
          <div class="youtube__wrap">
            <iframe src="https://www.youtube.com/embed/Rh53YVgsfJ4?rel=0&modestbranding=1&playsinline=1"
                    title="Markus Erling – Video" allow="autoplay; encrypted-media"
                    loading="lazy" referrerpolicy="no-referrer-when-downgrade" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </section>

    <!-- FLEUR -->
    <section id="fleur" class="card artist" data-artist="FLEURBENUINE">
      <div class="inner-block">
        <img class="artist__photo" src="artists/fleur_et_beunie/fotos/fleurbenuie_main.png" alt="Fleur &amp; Beunié"/>
        <h3 class="subhead">Biografie</h3>
        <div class="bio" data-bio-id="bio-fleur">
          <p class="bio-text collapsed">…</p>
          <button class="bio-toggle" type="button" aria-expanded="false" aria-controls="bio-fleur-content">Text erweitern</button>
        </div>
        <hr class="sandline"/>
        <div class="music-intro"><span class="music-label">Musik</span></div>

        <div class="track-list">
          <button class="track" type="button" data-release="feu">
            <div class="thumb"><img src="artists/fleur_et_beunie/cover/feu_leger_cover.png" alt="Cover: Feu Léger"></div>
            <div class="track-meta"><span class="track-title">Feu Léger</span></div>
          </button>
        </div>

        <div class="album-panel" hidden>
          <div class="album-panel__inner">
            <div class="cover-frame square">
              <img class="album-panel__cover" alt="Album Cover">
            </div>
            <div class="album-panel__players"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- SKANK SCHABLONSKI -->
    <section id="skank" class="card artist" data-artist="SKANK_SCHABLONSKI">
      <div class="inner-block">
        <img class="artist__photo" src="artists/skank_schablonski/fotos/skank_main.png" alt="Skank Schablonski"/>
        <h3 class="subhead">Biografie</h3>
        <div class="bio" data-bio-id="bio-schablonski">
          <p class="bio-text collapsed">…</p>
          <button class="bio-toggle" type="button" aria-expanded="false" aria-controls="bio-schablonski-content">Text erweitern</button>
        </div>
        <hr class="sandline"/>
        <div class="music-intro"><span class="music-label">Musik</span></div>

        <div class="track-list">
          <button class="track" type="button" data-release="merz">
            <div class="thumb"><img src="artists/skank_schablonski/cover/kohle_raus_cover.png" alt="Cover: Der Merz kommt"></div>
            <div class="track-meta"><span class="track-title">Der Merz kommt</span></div>
          </button>
        </div>

        <div class="album-panel" hidden>
          <div class="album-panel__inner">
            <div class="cover-frame square">
              <img class="album-panel__cover" alt="Album Cover">
            </div>
            <div class="album-panel__players"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- SKARAMUSH VANDANGO -->
    <section id="skaramush" class="card artist" data-artist="SKARAMUSH_VANDANGO">
      <div class="inner-block">
        <img class="artist__photo" src="artists/skaramush_vandango/fotos/skaramush_main.png" alt="SkaRamush Vandango"/>
        <h3 class="subhead">Biografie</h3>
        <div class="bio" data-bio-id="bio-skaramush">
          <p class="bio-text collapsed">…</p>
          <button class="bio-toggle" type="button" aria-expanded="false" aria-controls="bio-skaramush-content">Text erweitern</button>
        </div>
        <hr class="sandline"/>
        <div class="music-intro"><span class="music-label">Musik</span></div>

        <div class="track-list">
          <button class="track" type="button" data-release="fire">
            <div class="thumb"><img src="artists/skaramush_vandango/cover/cover_fire.png" alt="Cover: Set the World on fire"></div>
            <div class="track-meta"><span class="track-title">Set the World on fire</span></div>
          </button>
        </div>

        <div class="album-panel" hidden>
          <div class="album-panel__inner">
            <div class="cover-frame square">
              <img class="album-panel__cover" alt="Album Cover">
            </div>
            <div class="album-panel__players"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Headline-Rahmen: Kommentarfeld -->
    <div id="contact" class="headline-frame" aria-label="Kommentarfeld">
      <h2 class="headline-frame__title">Kommentarfeld</h2>
    </div>

    <!-- Kontakt -->
    <section class="card">
      <div class="inner-block">
        <form class="contact__form">
          <div class="field">
            <label for="name">Name</label>
            <input id="name" name="name" type="text" autocomplete="name" required>
          </div>
          <div class="field">
            <label for="email">E-Mail</label>
            <input id="email" name="email" type="email" autocomplete="email" required>
          </div>
          <div class="field">
            <label for="message">Nachricht</label>
            <textarea id="message" name="message" rows="4" required></textarea>
          </div>
          <button class="btn-send" type="submit">Abschicken</button>
        </form>
      </div>
    </section>

  </main>

  <footer class="footer">
    &copy; 2025 ROKKO! Records. Made in Ruhrpott.
  </footer>

  <!-- ======= Skript ======= -->
  <script>
    // Menü
    document.querySelector('.burger').addEventListener('click', function() {
      var menu = document.getElementById('menu');
      menu.classList.toggle('menu--open');
      this.setAttribute('aria-expanded', menu.classList.contains('menu--open'));
    });

    // Hero-Sound
    (function(){
      var introVideo = document.getElementById('introVideo');
      var soundBtn = document.getElementById('soundBtn');
      var isMuted = true;
      soundBtn.addEventListener('click', function() {
        isMuted = !isMuted;
        introVideo.muted = isMuted;
        soundBtn.textContent = isMuted ? 'Ton: Aus' : 'Ton: An';
        soundBtn.setAttribute('aria-pressed', String(!isMuted));
      });
    })();

    // Bio aus assets/data/bios.html laden + Teaser/Expand
    (function(){
      function trimTeaser(text, max) {
        const clean = (text||'').replace(/\s+/g,' ').trim();
        if (clean.length <= max) return clean;
        const cut = clean.lastIndexOf(' ', max-1);
        return (cut>0? clean.slice(0,cut) : clean.slice(0,max)).trim() + ' …';
      }
      function firstParagraphHTML(html) {
        const t = document.createElement('div'); t.innerHTML = html;
        const p = t.querySelector('p'); return p ? p.innerHTML : t.textContent || '';
      }
      fetch('assets/data/bios.html')
        .then(r=>r.text())
        .then(html=>{
          const src = document.createElement('div'); src.innerHTML = html;
          document.querySelectorAll('.bio').forEach(bio=>{
            const id = bio.getAttribute('data-bio-id');
            const node = src.querySelector('#'+id);
            if (!node) return;
            const fullHTML = node.innerHTML.trim();
            const firstP = firstParagraphHTML(fullHTML);
            const teaser = trimTeaser(firstP.replace(/<[^>]+>/g,'').replace(/\u00A0/g,' '), 260);

            let textEl = bio.querySelector('.bio-text');
            if (!textEl) { textEl = document.createElement('p'); textEl.className='bio-text'; bio.prepend(textEl); }
            textEl.textContent = teaser;
            textEl.classList.add('collapsed');
            bio.classList.remove('expanded');

            const toggle = bio.querySelector('.bio-toggle');
            if (toggle) {
              toggle.textContent = 'Text erweitern';
              toggle.setAttribute('aria-expanded', 'false');
              toggle.addEventListener('click', (e)=>{
                e.stopPropagation();
                const expanded = bio.classList.toggle('expanded');
                if (expanded) {
                  textEl.classList.remove('collapsed');
                  textEl.innerHTML = fullHTML;
                  toggle.textContent = 'Text einklappen';
                  toggle.setAttribute('aria-expanded', 'true');
                } else {
                  textEl.classList.add('collapsed');
                  textEl.textContent = teaser;
                  toggle.textContent = 'Text erweitern';
                  toggle.setAttribute('aria-expanded', 'false');
                }
              });
            }
          });
        })
        .catch(()=>{
          document.querySelectorAll('.bio .bio-text').forEach(el=>{
            el.textContent = 'Biografie konnte nicht geladen werden.';
          });
        });
    })();

    // ===== Audio-Pfade exakt nach ROOT (alle .m4a, alles klein) =====
    const RELEASES = {
      "HENRI": {
        "lafemme": {
          cover: "artists/henri_bellieu/cover/la_femme.png",
          tracks: [
            { name: "La Femme - Original Mix", src: "artists/henri_bellieu/audio_files/lafemme/la_femme_main.m4a" },
            { name: "La Femme - Deux Mix",     src: "artists/henri_bellieu/audio_files/lafemme/la_femme_deux.m4a" }
          ]
        },
        "colibri": {
          cover: "artists/henri_bellieu/cover/petite_colibri.png",
          tracks: [
            { name: "Petite Colibri - Original Mix",  src: "artists/henri_bellieu/audio_files/petitecolibri/petite_colibri_main.m4a" },
            { name: "Petite Colibri - Ennio Mix",     src: "artists/henri_bellieu/audio_files/petitecolibri/petite_colibri_ennio_mix.m4a" },
            { name: "Petite Colibri - Nocturne Mix",  src: "artists/henri_bellieu/audio_files/petitecolibri/petite_colibri_nocturne_mix.m4a" }
          ]
        }
      },
      "ERLING": {
        "schlafen": {
          cover: "artists/erling/cover/endlich_schlafen_cover.png",
          tracks: [
            { name: "endlich schlafen - Original Mix",  src: "artists/erling/audio_files/schlafen/endlich_schlafen_main.m4a" },
            { name: "endlich schlafen - MonoToni RMX",  src: "artists/erling/audio_files/schlafen/endlich_schlafen_monotoni.m4a" }
          ]
        },
        "regen": {
          cover: "artists/erling/cover/regen_cover.png",
          tracks: [
            { name: "Tag an dem es regnet - Original Mix", src: "artists/erling/audio_files/tagregnet/regnet_main.m4a" },
            { name: "Tag an dem es regnet - RMX",          src: "artists/erling/audio_files/tagregnet/regnet_rmx.m4a" }
          ]
        }
      },
      "FLEURBENUINE": {
        "feu": {
          cover: "artists/fleur_et_beunie/cover/feu_leger_cover.png",
          tracks: [
            { name: "Feu Léger - Original Mix", src: "artists/fleur_et_beunie/audio_files/feu_leger/feu_leger_main.m4a" },
            { name: "Feu Léger - Sundown Mix",  src: "artists/fleur_et_beunie/audio_files/feu_leger/feu_leger_sundown_mix.m4a" },
            { name: "Feu Léger - House Mix",    src: "artists/fleur_et_beunie/audio_files/feu_leger/feu_leger_house_mix.m4a" },
            { name: "Feu Léger - Classic Mix",  src: "artists/fleur_et_beunie/audio_files/feu_leger/feu_leger_french_classic_mix.m4a" },
            { name: "Feu Léger - Club Mix",     src: "artists/fleur_et_beunie/audio_files/feu_leger/feu_leger_club_mix.m4a" }
          ]
        }
      },
      "SKANK_SCHABLONSKI": {
        "merz": {
          cover: "artists/skank_schablonski/cover/kohle_raus_cover.png",
          tracks: [
            { name: "Kohle raus - Original Mix", src: "artists/skank_schablonski/audio_files/kohle_raus/kohle_raus_main.m4a" },
            { name: "Kohle raus - RMX",          src: "artists/skank_schablonski/audio_files/kohle_raus/kohle_raus_rmx.m4a" }
          ]
        }
      },
      "SKARAMUSH_VANDANGO": {
        "fire": {
          cover: "artists/skaramush_vandango/cover/cover_fire.png",
          tracks: [
            { name: "Set the world on Fire - Original Mix", src: "artists/skaramush_vandango/audio_files/set_fire/set_on_fire_original.m4a" },
            { name: "Set the world on Fire - RMX",          src: "artists/skaramush_vandango/audio_files/set_fire/set_on_fire_rmx.m4a" }
          ]
        }
      }
    };

    // Nur ein Player gleichzeitig
    let currentAudio = null;
    function stopCurrent() {
      if (currentAudio) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
        const btn = currentAudio._button;
        if (btn) btn.dataset.state = 'play';
        if (currentAudio._fill) currentAudio._fill.style.width = '0%';
        currentAudio = null;
      }
    }

    // Ausklappen + Player bauen
    document.addEventListener('click', function(e){
      const btn = e.target.closest('.track');
      if (!btn) return;

      const section = btn.closest('.artist');
      const artistKey = section.getAttribute('data-artist');
      const releaseKey = btn.getAttribute('data-release');
      const data = (RELEASES[artistKey] || {})[releaseKey];
      if (!data) return;

      const panel = section.querySelector('.album-panel');
      const coverEl = section.querySelector('.album-panel .album-panel__cover');
      const playersEl = section.querySelector('.album-panel .album-panel__players');

      coverEl.src = data.cover;
      coverEl.alt = btn.querySelector('.track-title')?.textContent || 'Album Cover';

      playersEl.innerHTML = '';
      data.tracks.forEach(t=>{
        const row = document.createElement('div'); row.className = 'player';

        const title = document.createElement('div'); title.className = 'player-title'; title.textContent = t.name;

        const controls = document.createElement('div'); controls.className = 'player-controls';

        const playBtn = document.createElement('button'); playBtn.className = 'player-btn'; playBtn.type = 'button'; playBtn.dataset.state = 'play'; playBtn.setAttribute('aria-label','Abspielen/Pause');

        const bar = document.createElement('div'); bar.className = 'player-progress'; bar.setAttribute('role','progressbar'); bar.setAttribute('aria-valuemin','0'); bar.setAttribute('aria-valuemax','100');
        const fill = document.createElement('div'); fill.className = 'player-progress__fill'; bar.appendChild(fill);

        controls.appendChild(playBtn); controls.appendChild(bar);
        row.appendChild(title); row.appendChild(controls);

        const audio = new Audio(); audio.src = t.src; audio.preload = 'none';
        audio._button = playBtn; audio._fill = fill;

        playBtn.addEventListener('click', () => {
          if (audio.paused) {
            stopCurrent();
            audio.play().catch(()=>{});
            currentAudio = audio;
            playBtn.dataset.state = 'pause';
          } else {
            audio.pause();
            playBtn.dataset.state = 'play';
          }
        });
        audio.addEventListener('timeupdate', () => {
          if (!isFinite(audio.duration) || audio.duration === 0) return;
          const p = (audio.currentTime / audio.duration) * 100;
          fill.style.width = p + '%';
          bar.setAttribute('aria-valuenow', String(Math.round(p)));
        });
        audio.addEventListener('ended', () => {
          playBtn.dataset.state = 'play';
          fill.style.width = '0%';
          if (currentAudio === audio) currentAudio = null;
        });
        audio.addEventListener('error', () => {
          const err = document.createElement('div'); err.className = 'track-error';
          err.textContent = 'Datei konnte nicht geladen werden (Pfad prüfen).';
          row.appendChild(err);
        });
        bar.addEventListener('click', (ev) => {
          const rect = bar.getBoundingClientRect();
          const x = ev.clientX - rect.left;
          const ratio = Math.min(Math.max(x / rect.width, 0), 1);
          if (isFinite(audio.duration)) audio.currentTime = ratio * audio.duration;
        });

        playersEl.appendChild(row);
      });

      // Panels toggeln
      document.querySelectorAll('.album-panel').forEach(p=>{
        if (p!==panel) {
          if (!p.hidden) stopCurrent();
          p.hidden = true;
        }
      });
      const willOpen = panel.hidden;
      if (!willOpen) stopCurrent();
      panel.hidden = !panel.hidden;
      if (!panel.hidden) panel.scrollIntoView({behavior:'smooth', block:'start'});
    });
  </script>
</body>
</html>
