<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ROKKO! Records</title>
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>
  <!-- FIXE TOPBAR -->
  <header class="topbar">
    <a href="/" class="brand" aria-label="Startseite">
      <img src="assets/Images/Logo.png" alt="ROKKO! Records" />
    </a>

    <!-- Hamburger nur Platzhalter â€“ verlinkst du spÃ¤ter -->
    <button class="hamburger" aria-label="MenÃ¼ Ã¶ffnen">
      <span></span><span></span><span></span>
    </button>
  </header>

  <!-- INTRO-BÃœHNE -->
  <section class="intro-wrap">
    <video id="introVideo" class="intro-video" playsinline autoplay muted preload="auto" poster="assets/wallpaper/wallpaper.jpg">
      <source src="assets/movies/intro_movie.mp4" type="video/mp4" />
      Dein Browser unterstÃ¼tzt HTML5-Video nicht.
    </video>

    <button id="muteToggle" class="mute-btn" aria-label="Audio ein-/ausschalten">ðŸ”‡</button>
    <div id="unmuteHint" class="unmute-hint" hidden>Tippen fÃ¼r Ton</div>
  </section>

  <!-- CONTENT-DUMMY -->
  <main class="content">
    <section class="block">
      <h1>Welcome to ROKKO! Records</h1>
      <p>Independent Label. Rockâ€™nâ€™Roll, Funk &amp; Freshness.</p>
    </section>
  </main>

  <script>
    (function () {
      const video = document.getElementById('introVideo');
      const btn   = document.getElementById('muteToggle');
      const hint  = document.getElementById('unmuteHint');

      // Mute-Status aus dem LocalStorage lesen
      const saved = localStorage.getItem('introMuted');
      const wantSound = (saved === null) ? true : (saved === 'false');

      function renderIcon(){
        btn.textContent = video.muted ? 'ðŸ”‡' : 'ðŸ”Š';
        btn.setAttribute('aria-label', video.muted ? 'Audio aus â€“ einschalten' : 'Audio an â€“ ausschalten');
      }

      async function startPlayback() {
        try {
          if (wantSound) video.muted = false;
          renderIcon();
          await video.play();
          hint.hidden = true;
        } catch (e) {
          // Autoplay mit Ton blockiert -> stumm starten, Hinweis zeigen
          video.muted = true;
          renderIcon();
          try { await video.play(); } catch(_) {}
          hint.hidden = false;
        }
      }

      if (video.readyState >= 2) startPlayback();
      else video.addEventListener('canplay', startPlayback, { once:true });

      btn.addEventListener('click', async () => {
        if (video.paused) { try { await video.play(); } catch(_) {} }
        video.muted = !video.muted;
        localStorage.setItem('introMuted', String(video.muted));
        renderIcon();
        hint.hidden = true;
      });

      // Sobald das Video zu Ende ist, auf dem letzten Frame stehen bleiben
      video.addEventListener('ended', () => {
        video.pause();
        // Zur letzten Position springen (minimal zurÃ¼ck, damit das Bild sicher gerendert bleibt)
        if (!isNaN(video.duration)) video.currentTime = video.duration - 0.05;
      });
    })();
  </script>
</body>
</html>
